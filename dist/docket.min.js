!function(t,e){"use strict";function i(t){if(!(this instanceof i))return new i(t);if(!t.parent)throw new Error("You must specify the parent element");this._docket=null,this._parent=null,this._posts=[],this._position="",this._margin=[],this._expires=null,this._targetPage="",this._targetItem=null,this._currDate=new Date,this._cookieName="docket-history",this._styles=".docket-pin{font:normal 12px/1 Arial,sans-serif !important;-webkit-box-sizing:border-box !important;box-sizing:border-box !important;position:absolute !important;display:inline-block !important;text-align:center !important;color:#fff !important;padding:4px 3px !important;height:19px !important;min-width:19px !important;-webkit-border-radius:50% !important;border-radius:50% !important;background-color:#fe0000 !important;-webkit-box-shadow:-1px 2px 3px rgba(0,0,0,0.4) !important;box-shadow:-1px 2px 3px rgba(0,0,0,0.4) !important}.docket-pin.docket-unpin{-webkit-animation:docket-unpin-animation .15s ease-out forwards;animation:docket-unpin-animation .15s ease-out forwards}@-webkit-keyframes docket-unpin-animation{from{opacity:1;-webkit-transform:scale(1);transform:scale(1)}to{opacity:0;-webkit-transform:scale(0);transform:scale(0)}}@keyframes docket-unpin-animation{from{opacity:1;-webkit-transform:scale(1);transform:scale(1)}to{opacity:0;-webkit-transform:scale(0);transform:scale(0)}}",this.init(t)}i.defaults={position:"right-top",margin:[0,0],expires:0},i.prototype.init=function(t){this._parent=e.querySelector(t.parent),this._posts=this.getPosts(this._parent.getAttribute("data-timestamp")),this._position=t.position||i.defaults.position,this._margin=t.margin||i.defaults.margin,this._expires=parseInt(t.expires)||i.defaults.expires,t.targetPage&&(this._targetPage=this.trimSlashes(t.targetPage.trim())),t.targetItem&&(this._targetItem=e.querySelector(t.targetItem)),this._posts&&this.checkConditions()},i.prototype.checkConditions=function(){var t=this.countItems();t>0&&this.createStyles().pinDocket(t),""!==this._targetPage?this._targetPage===this.trimSlashes(this.getLocation())&&this.setHistory().unpinDocket():this._targetItem},i.prototype.getPosts=function(t){var e=void 0!==t?t.split(","):"";if(""!==e[0]){for(var i=0;i<e.length;i++)e[i]=e[i].trim(),""===e[i]&&e.slice(i,1);return e}return!1},i.prototype.getLocation=function(){return t.location.href.toString().split(t.location.host)[1].split("?")[0]},i.prototype.trimSlashes=function(t){return t.replace(/^\/|\/$/g,"")},i.prototype.documentReady=function(t){(e.attachEvent?"complete"===e.readyState:"loading"!==e.readyState)?t():e.addEventListener("DOMContentLoaded",t)},i.prototype.createStyles=function(){var t=e.createElement("style"),i=this._position.split("-");return this._styles+=".docket-pin."+this._position+"{"+i[0]+":-"+this._margin[0]+"px;"+i[1]+":-"+this._margin[1]+"px}",t.setAttribute("id","docket-styles"),t.innerHTML=this._styles,e.body.appendChild(t),this},i.prototype.pinDocket=function(t){return this._docket=e.createElement("div"),this._docket.setAttribute("class","docket-pin "+this._position),this._docket.innerHTML=t,this._parent.style.position="relative",this._parent.appendChild(this._docket),this},i.prototype.writeCookie=function(t,i,o){o=o||{},i=encodeURIComponent(i);var n=o.expires,s=t+"="+i,r=this._currDate;for(var a in"number"==typeof n&&n&&(r.setTime(r.getTime()+1e3*n),n=o.expires=r),n&&n.toUTCString&&(o.expires=n.toUTCString()),o)s+="; "+a,!0!==o[a]&&(s+="="+o[a]);e.cookie=s},i.prototype.readCookie=function(t){var i=e.cookie.match(new RegExp("(?:^|; )"+t.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return i?decodeURIComponent(i[1]):void 0},i.prototype.countItems=function(){var t=this._posts.length,e=this.readCookie(this._cookieName);if(e){e=e.split(",");for(var i=0;i<e.length;i++)-1!==this._posts.indexOf(e[i])&&t--}return t},i.prototype.setHistory=function(){return this.writeCookie(this._cookieName,this._posts.toString(),{path:"/",expires:this._expires}),this},i.prototype.unpinDocket=function(){return null!==this._docket&&this.documentReady(function(){setTimeout(function(){this._docket.classList.add("docket-unpin")}.bind(this),500)}.bind(this)),this},i.prototype.deleteCookie=function(){this.writeCookie(this._cookieName,"",{path:"/",expires:-1})},t.Docket=i}(window,document);